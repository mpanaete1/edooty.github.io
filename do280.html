<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>

<link href='https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext' rel='stylesheet' type='text/css' /><style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color:#ffffff; --text-color:#333333; --select-text-bg-color:#B5D6FC; --select-text-font-color:auto; --monospace:"Lucida Console",Consolas,"Courier",monospace; --title-bar-height:20px; }
.mac-os-11 { --title-bar-height:28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; inset: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; tab-size: 4; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror-linenumber { user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; padding-top: 0px; border-color: transparent !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.6; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background: inherit; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex:2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) {
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) {
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.42857rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: ""; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: ""; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left: 28px solid transparent; border-right: 28px solid transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: ""; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right: 8px solid transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "−"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }
.md-inline-math-container mjx-container { zoom: 0.95; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); background: inherit; white-space: nowrap; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; outline: 0px; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: auto hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 10px; z-index: 3; overflow-y: hidden; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: 0px 0px !important; border: none !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: 0px 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; overflow-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { overflow-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right: 30px solid transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right: none; width: auto; }
.CodeMirror-linebackground { position: absolute; inset: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
span.cm-underlined { text-decoration: underline; }
span.cm-strikethrough { text-decoration: line-through; }
.cm-tw-syntaxerror { color: rgb(255, 255, 255); background-color: rgb(153, 0, 0); }
.cm-tw-deleted { text-decoration: line-through; }
.cm-tw-header5 { font-weight: 700; }
.cm-tw-listitem:first-child { padding-left: 10px; }
.cm-tw-box { border-style: solid; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-color: inherit; border-top-width: 0px !important; }
.cm-tw-underline { text-decoration: underline; }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


:root {
    --side-bar-bg-color: #fafafa;
    --control-text-color: #777;
}

@include-when-export url(https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext);

/* open-sans-regular - latin-ext_latin */
  /* open-sans-italic - latin-ext_latin */
    /* open-sans-700 - latin-ext_latin */
    /* open-sans-700italic - latin-ext_latin */
  html {
    font-size: 16px;
    -webkit-font-smoothing: antialiased;
}

body {
    font-family: "Open Sans","Clear Sans", "Helvetica Neue", Helvetica, Arial, 'Segoe UI Emoji', sans-serif;
    color: rgb(51, 51, 51);
    line-height: 1.6;
}

#write {
    max-width: 860px;
  	margin: 0 auto;
  	padding: 30px;
    padding-bottom: 100px;
}

@media only screen and (min-width: 1400px) {
	#write {
		max-width: 1024px;
	}
}

@media only screen and (min-width: 1800px) {
	#write {
		max-width: 1200px;
	}
}

#write > ul:first-child,
#write > ol:first-child{
    margin-top: 30px;
}

a {
    color: #4183C4;
}
h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1rem;
    margin-bottom: 1rem;
    font-weight: bold;
    line-height: 1.4;
    cursor: text;
}
h1:hover a.anchor,
h2:hover a.anchor,
h3:hover a.anchor,
h4:hover a.anchor,
h5:hover a.anchor,
h6:hover a.anchor {
    text-decoration: none;
}
h1 tt,
h1 code {
    font-size: inherit;
}
h2 tt,
h2 code {
    font-size: inherit;
}
h3 tt,
h3 code {
    font-size: inherit;
}
h4 tt,
h4 code {
    font-size: inherit;
}
h5 tt,
h5 code {
    font-size: inherit;
}
h6 tt,
h6 code {
    font-size: inherit;
}
h1 {
    font-size: 2.25em;
    line-height: 1.2;
    border-bottom: 1px solid #eee;
}
h2 {
    font-size: 1.75em;
    line-height: 1.225;
    border-bottom: 1px solid #eee;
}

/*@media print {
    .typora-export h1,
    .typora-export h2 {
        border-bottom: none;
        padding-bottom: initial;
    }

    .typora-export h1::after,
    .typora-export h2::after {
        content: "";
        display: block;
        height: 100px;
        margin-top: -96px;
        border-top: 1px solid #eee;
    }
}*/

h3 {
    font-size: 1.5em;
    line-height: 1.43;
}
h4 {
    font-size: 1.25em;
}
h5 {
    font-size: 1em;
}
h6 {
   font-size: 1em;
    color: #777;
}
p,
blockquote,
ul,
ol,
dl,
table{
    margin: 0.8em 0;
}
li>ol,
li>ul {
    margin: 0 0;
}
hr {
    height: 2px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
    overflow: hidden;
    box-sizing: content-box;
}

li p.first {
    display: inline-block;
}
ul,
ol {
    padding-left: 30px;
}
ul:first-child,
ol:first-child {
    margin-top: 0;
}
ul:last-child,
ol:last-child {
    margin-bottom: 0;
}
blockquote {
    border-left: 4px solid #dfe2e5;
    padding: 0 15px;
    color: #777777;
}
blockquote blockquote {
    padding-right: 0;
}
table {
    padding: 0;
    word-break: initial;
}
table tr {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 0;
}
table tr:nth-child(2n),
thead {
    background-color: #f8f8f8;
}
table th {
    font-weight: bold;
    border: 1px solid #dfe2e5;
    border-bottom: 0;
    margin: 0;
    padding: 6px 13px;
}
table td {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 6px 13px;
}
table th:first-child,
table td:first-child {
    margin-top: 0;
}
table th:last-child,
table td:last-child {
    margin-bottom: 0;
}

.CodeMirror-lines {
    padding-left: 4px;
}

.code-tooltip {
    box-shadow: 0 1px 1px 0 rgba(0,28,36,.3);
    border-top: 1px solid #eef2f2;
}

.md-fences,
code,
tt {
    border: 1px solid #e7eaed;
    background-color: #f8f8f8;
    border-radius: 3px;
    padding: 0;
    padding: 2px 4px 0px 4px;
    font-size: 0.9em;
}

code {
    background-color: #f3f4f4;
    padding: 0 2px 0 2px;
}

.md-fences {
    margin-bottom: 15px;
    margin-top: 15px;
    padding-top: 8px;
    padding-bottom: 6px;
}


.md-task-list-item > input {
  margin-left: -1.3em;
}

@media print {
    html {
        font-size: 13px;
    }
    table,
    pre {
        page-break-inside: avoid;
    }
    pre {
        word-wrap: break-word;
    }
}

.md-fences {
	background-color: #f8f8f8;
}
#write pre.md-meta-block {
	padding: 1rem;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border: 0;
    border-radius: 3px;
    color: #777777;
    margin-top: 0 !important;
}

.mathjax-block>.code-tooltip {
	bottom: .375rem;
}

.md-mathjax-midline {
    background: #fafafa;
}

#write>h3.md-focus:before{
	left: -1.5625rem;
	top: .375rem;
}
#write>h4.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h5.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h6.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
.md-image>.md-meta {
    /*border: 1px solid #ddd;*/
    border-radius: 3px;
    padding: 2px 0px 0px 4px;
    font-size: 0.9em;
    color: inherit;
}

.md-tag {
    color: #a7a7a7;
    opacity: 1;
}

.md-toc { 
    margin-top:20px;
    padding-bottom:20px;
}

.sidebar-tabs {
    border-bottom: none;
}

#typora-quick-open {
    border: 1px solid #ddd;
    background-color: #f8f8f8;
}

#typora-quick-open-item {
    background-color: #FAFAFA;
    border-color: #FEFEFE #e5e5e5 #e5e5e5 #eee;
    border-style: solid;
    border-width: 1px;
}

/** focus mode */
.on-focus-mode blockquote {
    border-left-color: rgba(85, 85, 85, 0.12);
}

header, .context-menu, .megamenu-content, footer{
    font-family: "Segoe UI", "Arial", sans-serif;
}

.file-node-content:hover .file-node-icon,
.file-node-content:hover .file-node-open-state{
    visibility: visible;
}

.mac-seamless-mode #typora-sidebar {
    background-color: #fafafa;
    background-color: var(--side-bar-bg-color);
}

.md-lang {
    color: #b4654d;
}

/*.html-for-mac {
    --item-hover-bg-color: #E6F0FE;
}*/

#md-notification .btn {
    border: 0;
}

.dropdown-menu .divider {
    border-color: #e5e5e5;
    opacity: 0.4;
}

.ty-preferences .window-content {
    background-color: #fafafa;
}

.ty-preferences .nav-group-item.active {
    color: white;
    background: #999;
}

.menu-item-container a.menu-style-btn {
    background-color: #f5f8fa;
    background-image: linear-gradient( 180deg , hsla(0, 0%, 100%, 0.8), hsla(0, 0%, 100%, 0)); 
}



</style><title>do280</title>
</head>
<body class='typora-export os-windows'><div class='typora-export-content'>
<div id='write'  class=''><h1>Red Hat OpenShift Admin II: Operating a Production Kubernetes Cluster (DO280)</h1><p><a href='d0280.html'><span>Home</span></a></p><div class='md-toc' mdtype='toc'><p class="md-toc-content" role="list"><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n12"><a class="md-toc-inner" href="#describing-the-red-hat-openshift-container-platform">Describing the Red Hat OpenShift Container Platform</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n15"><a class="md-toc-inner" href="#platform-features">Platform Features</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n56"><a class="md-toc-inner" href="#architecture-of-openshift">Architecture of OpenShift</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n75"><a class="md-toc-inner" href="#cluster-operators">Cluster Operators</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n109"><a class="md-toc-inner" href="#verifying-the-health-of-a-cluster">Verifying the Health of a Cluster</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n112"><a class="md-toc-inner" href="#installation-methods">Installation Methods</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n139"><a class="md-toc-inner" href="#troubleshooting-clusters-and-applications">Troubleshooting Clusters and Applications</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n171"><a class="md-toc-inner" href="#dynamic-storage">Dynamic Storage</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n189"><a class="md-toc-inner" href="#configuring-authentication-and-authorization">Configuring Authentication and Authorization</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n192"><a class="md-toc-inner" href="#identity-providers">Identity Providers</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n281"><a class="md-toc-inner" href="#permissions-using-role-based-access-control-rbac">Permissions using Role-Based Access Control (RBAC)</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n306"><a class="md-toc-inner" href="#configuring-application-security">Configuring Application Security</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n309"><a class="md-toc-inner" href="#managing-sensitive-information-with-secrets">Managing Sensitive Information with Secrets</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n342"><a class="md-toc-inner" href="#application-permissions-with-security-context-constraints">Application Permissions with Security Context Constraints</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n396"><a class="md-toc-inner" href="#configuring-openshift-networking-for-applications">Configuring OpenShift Networking for Applications</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n399"><a class="md-toc-inner" href="#troubleshooting-software-defined-networking">Troubleshooting Software-defined Networking</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n441"><a class="md-toc-inner" href="#exposing-applications-for-external-access">Exposing Applications for External Access</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n479"><a class="md-toc-inner" href="#configuring-network-policies">Configuring Network Policies</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n488"><a class="md-toc-inner" href="#exam-help-with-networking">Exam help with networking </a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n514"><a class="md-toc-inner" href="#controlling-pod-scheduling">Controlling Pod Scheduling</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n517"><a class="md-toc-inner" href="#pod-scheduling-behavior">Pod Scheduling Behavior</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n562"><a class="md-toc-inner" href="#limiting-resource-usage">Limiting Resource Usage</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n591"><a class="md-toc-inner" href="#scaling-an-application">Scaling an Application</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n608"><a class="md-toc-inner" href="#exam-help-with-pod-scheduling">Exam Help With Pod Scheduling</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n628"><a class="md-toc-inner" href="#describing-cluster-updates">Describing Cluster Updates</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n631"><a class="md-toc-inner" href="#cluster-update-process">Cluster Update Process</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n662"><a class="md-toc-inner" href="#managing-a-cluster-with-the-web-console">Managing a Cluster with the Web Console</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n665"><a class="md-toc-inner" href="#cluster-administration">Cluster Administration</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n688"><a class="md-toc-inner" href="#managing-workloads-and-operators">Managing Workloads and Operators</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n703"><a class="md-toc-inner" href="#examining-cluster-metrics">Examining Cluster Metrics</a></span></p></div><p><span>Exam Info : </span><a href='https://www.redhat.com/en/services/training/ex280-red-hat-certified-specialist-in-openshift-administration-exam' target='_blank' class='url'>https://www.redhat.com/en/services/training/ex280-red-hat-certified-specialist-in-openshift-administration-exam</a></p><p><span>General Exam Information:</span></p><p><a href='https://www.redhat.com/rhdc/managed-files/tr-remote-exams-preparation-ebook-f27382-202103-en.pdf' target='_blank' class='url'>https://www.redhat.com/rhdc/managed-files/tr-remote-exams-preparation-ebook-f27382-202103-en.pdf</a><span> </span></p><p><a href='https://source.redhat.com/career/developmentplanning/startlearning/red_hat_university_wiki/red_hat_training_rht_courses_and_certifications_for_red_hat_employees' target='_blank' class='url'>https://source.redhat.com/career/developmentplanning/startlearning/red_hat_university_wiki/red_hat_training_rht_courses_and_certifications_for_red_hat_employees</a></p><p><span>Documentation: </span><a href='https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6' target='_blank' class='url'>https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6</a></p><p><span>HTTPauth: </span><a href='https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6/html/authentication_and_authorization/configuring-identity-providers' target='_blank' class='url'>https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6/html/authentication_and_authorization/configuring-identity-providers</a></p><p><span>Instructor: Mike Dickner, Email: </span><a href='mailto:michaeld@redhat.com' target='_blank' class='url'>michaeld@redhat.com</a><span> , </span><a href='mailto:mdickner@redhat.com' target='_blank' class='url'>mdickner@redhat.com</a></p><p>&nbsp;</p><h2 id='describing-the-red-hat-openshift-container-platform'><span>Describing the Red Hat OpenShift Container Platform</span></h2><p>〰️〰️〰️</p><p><a href='do280.html'><span>Top</span></a></p><h3 id='platform-features'><span>Platform Features</span></h3><p><strong><span>Introducing OpenShift Container Platform</span></strong></p><ul><li><strong><span>OpenShift Container Platform</span></strong><span> is based on Kubernetes and extends the platform with features.</span></li><li><strong><span>Container Platform</span></strong><span> - enterprise ready Kubernetes environment - building, deploying, and managing container based apps. </span></li><li><strong><span>Dedicated</span></strong><span> - managed in a public cloud, Red hat manages for you</span></li><li><strong><span>Online</span></strong><span> - hosted, public container orchestration platform that offers an app hosting solution based in a cloud environment, shared across multiple customers</span></li><li><strong><span>Kubernetes Engine</span></strong><span> - streamline version of OpenShift. Provides a subset of features.</span></li><li><strong><span>Ready Containers</span></strong><span> - minimal installation of OpenShift you can run on a laptop for local development.</span></li></ul><p>&nbsp;</p><p><strong><span>Services and Features</span></strong></p><p><img src="/home/eduty/.var/app/io.typora.Typora/config/Typora/typora-user-images/image-20220118102146612.png" referrerpolicy="no-referrer" alt="image-20220118102146612"></p><p>&nbsp;</p><p><strong><span>OpenShift Features</span></strong></p><p><span>Several features that are enabled by Kubernetes and most require additional components that you need to add and configure.</span></p><ul><li><span>High Availability - Minimum of 3 servers for a OpenShift Cluster/Kubernetes allows for high availability.</span></li><li><span>Lightweight OS</span></li><li><span>Load Balancing - include 3 types of load balancers</span></li><li><span>Automating Scaling </span></li><li><span>Logging and Monitoring - the prometheus tool obtains detailed information</span></li><li><span>Service Discovery  - runs an internal dns service on the cluster</span></li><li><span>Storage </span></li><li><span>App Management - source-to-image (S2I) to automatically build containers based on source code.</span></li><li><span>Cluster Extensibility - modular in nature</span></li></ul><p>&nbsp;</p><h3 id='architecture-of-openshift'><span>Architecture of OpenShift</span></h3><p><a href='do280.html'><span>Top</span></a></p><p><span>Declarative nature, looking for an end result and creating the state you want. Self- optimizing and self-healing systems.</span></p><p><span>Controllers monitor/exam the state of resources and comparing what you have to what you wanted. They will adjust to ensure what you want is what you have. </span></p><p><span>Control Plane - 3 machines minimum. In charge and running the show. Some static pods:</span></p><ul><li><span>Run Time - CRI-O </span></li><li><span>API</span></li><li><span>Authentication/authorization</span></li><li><span>Ansible play</span></li><li><span>etcd</span></li></ul><p><strong><span>Extensions</span></strong><span> - external components to pick and choose to build a Kubernetes distribution. </span></p><p><strong><span>Default Storage Class</span></strong><span> - cluster admin will create a persistent volume. The application would make a persistent volume claim to the persistent volume. OpenShift ships with integrated storage plug-ins and storage classes. </span></p><p>&nbsp;</p><h3 id='cluster-operators'><span>Cluster Operators</span></h3><p><span>Operators are managing kubernetes itself and manage other components needed, such as routes, services., etc. </span></p><p><strong><span>Operator SDK</span></strong><span> - set of global librarires and source code that implement common pattern sin operator apps</span></p><p><strong><span>Operator Life Cycle manager</span></strong><span> - app that manages the deployment, resources, updates of operators that have been deployed through an operator catalog</span></p><p><strong><span>Red hat marketplace</span></strong><span> - access to curated set of enterprise grade operators that can be deployed on an OpenShift or Kubernetes cluster.</span></p><p><strong><span>Cluster Operators</span></strong><span> - they are not managed by the Operator Lifecycle manager (OLM), they are managed by the OpenShift cluster version operator. aka first-level operator. All cluster operators aka second-level operators. They provide OpenShift extension APIs and infrastructure services</span></p><p><span>Some Cluster Operators</span></p><ul><li><span>network</span></li><li><span>ingress</span></li><li><span>storage</span></li><li><span>authentication</span></li><li><span>console</span></li><li><span>monitoring</span></li><li><span>image-registry</span></li><li><span>cluster-autoscaler</span></li><li><span>openshift-apiserver</span></li><li><span>dns</span></li><li><span>openshift-controller-manager</span></li><li><span>cloud-credential</span></li></ul><hr /><p>&nbsp;</p><h2 id='verifying-the-health-of-a-cluster'><span>Verifying the Health of a Cluster</span></h2><p>〰️〰️〰️</p><p><a href='do280.html'><span>Top</span></a></p><h3 id='installation-methods'><span>Installation Methods</span></h3><p><strong><span>Full- Stack Automation</span></strong></p><p><span>Requires: CoreOS</span></p><p><span>Installer provisioned infrastructure. OpenShift installer provisions all compute,storage,and network resources from a cloud or visualization provider. You provide the cloud provider with with minimum data and they will install it for you.</span></p><p><span>Cloud Providers - AWS, GCP, Azure, OpenStack</span></p><p><strong><span>Pre-existing Infrastructure</span></strong></p><p><span>User-provisioned. you configure the installation and provide the details. More flexibility. </span></p><p>&nbsp;</p><p><strong><span>Deployment Process</span></strong></p><ol start='' ><li><span>The bootstrap machine boots, and then starts hosting the remote resources required for</span>
<span>booting the control plane machines.</span></li><li><span>The control plane machines fetch the remote resources from the bootstrap machine and</span>
<span>finish booting.</span></li><li><span>The control plane machines form an Etcd cluster.</span></li><li><span>The bootstrap machine starts a temporary Kubernetes control plane using the newly-created</span>
<span>Etcd cluster.</span></li><li><span>The temporary control plane schedules the control plane to the control plane machines.</span></li><li><span>The temporary control plane shuts down and yields to the control plane.</span></li><li><span>The bootstrap node injects components specific to OpenShift into the control plane.</span></li><li><span>Finally, the installer tears down the bootstrap machine.</span></li></ol><p>&nbsp;</p><h3 id='troubleshooting-clusters-and-applications'><span>Troubleshooting Clusters and Applications</span></h3><p><strong><span>Verify the Health of OpenShift Nodes</span></strong></p><p><span>config for the login information: </span><code>/usr/local/etc/ocp4.confg</code></p><p><span>Login: </span><code>oc login -u &lt;user&gt; -p &lt;password&gt; &lt;api location&gt;</code></p><p><span>Get Help: </span><code>oc help</code></p><p><span>	</span><code>oc new-project --help</code></p><p><span>Get Cluster Version: </span><code>oc get clusterversion</code></p><p><span>list cluster operators: </span><code>oc get clusteroperators</code></p><p><span>List nodes: </span><code>oc get nodes</code><span> </span></p><p><span>	</span><span>master = control plane</span></p><p><span>Errors events: </span><code>oc get events</code></p><p><span>Edit config: </span><code>oc edit &lt;deployment/psql&gt;</code></p><p><span>Are nodes resources properly allocated (mem,cpu): </span><code>oc adm top nodes</code></p><p><span>	</span><code>oc adm</code><span> is typically cluster wide</span></p><p><span>Get more information on a specific node: </span><code>oc describe node &lt;node name&gt;</code></p><p><strong><span>Logs</span></strong></p><p><span>View node logs: </span><code>oc adm node-logs -u &lt;crio/kubelet&gt; &lt;node name&gt;</code></p><p><span>all journal logs: </span><code>oc adm node-logs &lt;node name&gt;</code></p><p><span>	</span><span>use </span><code>| tail -f</code><span> for live view</span></p><p><strong><span>Open Shell prompt on Node</span></strong></p><p><code>oc debug node/&lt;node name&gt;</code><span> </span></p><p><code>chroot /host</code></p><p><strong><span>Troubleshoot failed to start, running and terminated pods</span></strong></p><p><code>oc get pod</code><span> and </span><code>oc status</code><span> to check error state</span></p><p><span>Check logs  to get more info </span><code>oc logs &lt;pod name&gt; -c &lt;container name&gt;</code></p><p><strong><span>Changing a running container</span></strong></p><p><span>Open Shell -  </span><code>oc rsh &lt;pod name&gt;</code></p><p><span>Copies local files to a pod: </span><code>oc cp /local/path &lt;pod name&gt;:/container/path</code></p><p><span>Temporary TCP tunnel: </span><code>oc port-forward &lt;pod name&gt; &lt;localport:remoteport&gt;</code></p><p><strong><span>Web troubleshoot</span></strong></p><p><span>Get url for web gui: </span><code>oc whoami --show-console</code><span> </span></p><p>&nbsp;</p><h3 id='dynamic-storage'><span>Dynamic Storage</span></h3><p><a href='do280.html'><span>Top</span></a></p><p><span>Volumes  and bind mounts. managed by admins or dynamically through a storage class, a way to define storage.</span></p><p><span>Persistent Volume (PV) Claim (PVC)- can specify additional criteria, such as the name of the storage class. PVC request persitent volumes resources.</span></p><p><span>	</span><span>Static - requires the cluster admins to create PV manually</span></p><p><span>	</span><span>Dynamic - uses storage classes to create the PV on demand</span></p><p><span>verify with : </span><code>oc get storageclass</code></p><p>&nbsp;</p><p><strong><span>Deploying Dynamic Provisioned storage</span></strong></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">oc set volumes deployment/example-application \</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">--add --name example-storage --type pvc --claim-class nfs-storage \</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">--claim-mode rwo --claim-size 15Gi --mount-path /var/lib/example-app \</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">--claim-name example-storage</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 92px;"></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></pre><p><span>or Specify PersistentVolumeClassAPI with a YAML file</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">apiVersion: v1</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">kind: PersistentVolumeClaim</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">metadata:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">name: example-pv-claim</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">labels:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">app: example-application</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">spec:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">accessModes:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- ReadWriteOnce</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">resources:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">requests:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">storage: 15Gi</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 276px;"></div><div class="CodeMirror-gutters" style="display: none; height: 276px;"></div></div></div></pre><p><span>add PVC to the app</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">spec:</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">volumes:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- name: example-pv-storage</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">persistentVolumeClaim:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">claimName: example-pv-claim</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">containers:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- name: example-application</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">image: registry.redhat.io/rhel8/example-app</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ports:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- containerPort: 1234</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">volumeMounts:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- mountPath: "/var/lib/example-app"</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">name: example-pv-storage</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 299px;"></div><div class="CodeMirror-gutters" style="display: none; height: 299px;"></div></div></div></pre><p>&nbsp;</p><p><span>Delete PVC : </span><code>oc delete pvc/&lt;example storage&gt;</code></p><hr /><p>&nbsp;</p><h2 id='configuring-authentication-and-authorization'><span>Configuring Authentication and Authorization</span></h2><p>〰️〰️〰️</p><p><a href='do280.html'><span>Top</span></a></p><h3 id='identity-providers'><span>Identity Providers</span></h3><p><strong><span>Resource Types and Definitions</span></strong></p><figure><table><thead><tr><th><span>Resource</span></th><th><span>Definition</span></th></tr></thead><tbody><tr><td><span>User</span></td><td><span>interact with the API serer. represents an actor within the system</span></td></tr><tr><td><span>Identity</span></td><td><span>keeps a record of successful authenication attempts from a specific user. source of authentication is stored on the identity</span></td></tr><tr><td><span>Service Account</span></td><td><span>enable you to control API access without the need to borrow a regular users creds</span></td></tr><tr><td><span>Group</span></td><td><span>specific set of users</span></td></tr><tr><td><span>Role</span></td><td><span>a set of permissions that enables a user to perform API operations over one or more resource types</span></td></tr></tbody></table></figure><p>&nbsp;</p><p><strong><span>Authenticating API requests</span></strong></p><p><span>Two methods for authenitcation requests</span></p><ul><li><p><span>OAuth Access Token</span></p><p><span>OpenShift provides the Authentication operator which runs an OAuth server. An identity provider must be configured and available to the OAuth server.</span></p></li><li><p><span>X.509 Client Certificates</span></p></li></ul><p><strong><span>Identity Providers</span></strong></p><p><span>OAuth server can be configured to use many identity providers:</span></p><ul><li><span>HTPasswd</span></li><li><span>Keystone</span></li><li><span>LDAP</span></li><li><span>GitHub or GitHub Enterprise</span></li><li><span>OpenID Connect</span></li></ul><p>&nbsp;</p><p><span>Before you can configure an identity provider , you must access your OpenShift cluster as a cluster admin.</span></p><p><strong><span>Authenticate using the X.509 Certificate</span></strong></p><p><span>Logs: kubeconfig file</span></p><p><code>export KUBECONFIG=/home/user/auth/kubeconfig</code>
<code>oc get nodes</code></p><p><span>as an alternative : </span><code>oc --kubeconfig /home/user/auth/kubeconfig get nodes</code></p><p><strong><span>Authenticate using a Virtual User</span></strong></p><p><code>oc login -u kubeadmin -p &lt;password&gt;</code></p><p><span>creds stored in the cluster installation logs.</span></p><p>&nbsp;</p><p><strong><span>Configuring the HTPasswd Identity Provider</span></strong></p><p><a href='https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6/html/authentication_and_authorization/configuring-identity-providers' target='_blank' class='url'>https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6/html/authentication_and_authorization/configuring-identity-providers</a></p><p><span>validates users against a secret that contains user names and passwords generated with the </span><code>htpasswd</code><span> command.</span></p><ol start='' ><li><p><span>create a password file</span></p><p><code>yum provides htpasswd</code></p><p><code>yum install httpd-tools</code></p><p><code>htpasswd -c -B (bcrypt) -b &lt;name of file/htpasswd&gt; &lt;username&gt; &lt;password&gt;</code></p><p><span>	</span><span>first time with -c to create the htpasswd file, remove -c to add users</span></p><p><span>create addinitional users: </span><code>htpasswd -b &lt;file name&gt; &lt;username&gt; &lt;password&gt;</code></p></li><li><p><span>Build a secret (contains the data (base64 encoded))</span></p></li></ol><p><span>		</span><code>oc create secret generic &lt;name/htpasswd-secret&gt; --from-file htpasswd=&lt;location of file created in step 1&gt; -n openshift-config</code></p><ol start='3' ><li><p><span>Custom resource for OAuth </span></p><p><span>copy from documentation  &lt;name.yaml&gt;</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">apiVersion: config.openshift.io/v1</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">kind: OAuth</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">metadata:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>name:cluster</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">spec:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>identityProvders:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>-htpasswd:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>fileData:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>name: htpasswd-secret  (name from step 2)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>mappingMethod: claim</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>name: &lt;name like localusers&gt;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>type: HTPasswd</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 276px;"></div><div class="CodeMirror-gutters" style="display: none; height: 276px;"></div></div></div></pre><p><span>process : </span><code>oc replace -f /location/of/.yaml file</code></p></li></ol><p><span>	</span><span>4. </span><code>oc get pods -n openshift-authentication</code></p><p><span>	</span></p><p><strong><span>Edit Users/Passwords:</span></strong><span> </span><code>oc extract secret/htpasswd-secret -n openshift-config --to &lt;directory&gt; --confirm</code></p><p><span>	</span><span>extracts the file with the users</span></p><p><span>	</span><span>added a user to htpasswd - </span><code>htpasswd -b htpasswd &lt;user&gt; &lt;pass&gt;</code><span>  </span></p><p><span>	</span><span>remove user - </span><code>htpasswd -D htpasswd &lt;user&gt;</code></p><p><span>	</span><span>Update the secret : </span><code>oc set data secret/htpasswd-secret --from-file htpasswd=&lt;new directory&gt;</code></p><p>&nbsp;</p><p><strong><span>Adding  Admin Privileges/Roles</span></strong></p><p><code>oc adm policy add-cluster-role-to-user &lt;rolename/cluster-admin&gt; &lt;user&gt;</code></p><p>&nbsp;</p><p><strong><span>Groups</span></strong></p><p><code>oc adm groups --help</code></p><p><span>	</span><code>oc adm groups new &lt;group name&gt;</code></p><p><span>	</span><code>oc adm groups new &lt;groupname&gt; &lt;user&gt; &lt;user&gt;</code></p><p>&nbsp;</p><h3 id='permissions-using-role-based-access-control-rbac'><span>Permissions using Role-Based Access Control (RBAC)</span></h3><p><span>a technique for managing access to resources in a computer system. (roles)</span></p><p><span>User, Group, or Service account and adding roles (cluster or local)</span></p><p><span>Roles - a set of rules</span></p><p><span>Binding - assignment of users or groups to roles</span></p><p><span>Rule - allowed actions for objects or groups of objects</span></p><p><span>Cluster Role -  manage the OpenShift cluster</span></p><p><span>Local Role - only manage elements at a project level</span></p><p><code>oc adm policy add-cluster-role-to-user/group &lt;cluster role&gt; &lt;username&gt;</code></p><p><span>	</span><span>when you see adm its a cluster role</span></p><p><span>Remove - </span><code>oc adm policy remove-cluster-role-to-user/group &lt;cluster role&gt; &lt;username&gt;</code></p><p><span>Check access - </span><code>oc adm policy who-can delete user</code></p><p>&nbsp;</p><p><strong><span>Default Roles</span></strong></p><p><span>admin - manage all projects</span></p><p><span>basic-user - read access to the project</span></p><p><span>cluster-admin -any action on the cluster</span></p><p><span>cluster-status - get cluster status</span></p><p><span>edit - can create,chage,and delete common app resources from the project</span></p><p><span>self-provisioner - create new projects, a cluster role not project role. Cannot do anything else</span></p><p><span>view - view read only project resource</span></p><p>&nbsp;</p><p><span>Add specified role to a user: </span><code>oc policy add-role-to-user &lt;role name&gt; &lt;username&gt; -n &lt;project name&gt;</code></p><hr /><p>&nbsp;</p><h2 id='configuring-application-security'><span>Configuring Application Security</span></h2><p>〰️〰️〰️</p><p><a href='do280.html'><span>Top</span></a></p><h3 id='managing-sensitive-information-with-secrets'><span>Managing Sensitive Information with Secrets</span></h3><p><a href='https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6/html/nodes/working-with-pods#nodes-pods-secrets' target='_blank' class='url'>https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6/html/nodes/working-with-pods#nodes-pods-secrets</a></p><p><span>Secret resources hold , passwords, sensitive config files, credentials to external resources like SSH key or OAuth token.</span></p><p><span>Not encrypted, just base64 encoded</span></p><p><span>encrypt etcd database if you want to encrypt. (not in scope for exam)</span></p><p><strong><span>Features</span></strong></p><p><span>secret data can be shared within projects</span></p><p><span>manage a secret and team members can reference in their deployment</span></p><p><span>injected into pods. Expose a secret as an env variable or mounted file system</span></p><p><span>When a pod is destroyed so is the secret, you need to create a new pod to inject new secret data</span></p><p>&nbsp;</p><p><strong><span>Creating a Secret</span></strong></p><p><span>create generic secret with key-value pair</span></p><p><code>oc create secret generic &lt;secret name&gt; --from-literal key1=secret1 --from-literal key2=secret2</code></p><p><span>create from files</span></p><p><code>oc create secret generic ssh-keys --from-file id_rsa=/path-to/id_rsa --from-file id_rsa.pub=/path-to/id_rsa.pub</code></p><p><span>Create a TLS secret</span></p><p><code>oc create secret tls secret-tls --cert /path-to-certificate --key /path-to-key</code></p><p>&nbsp;</p><p><strong><span>Expose Secrets to Pods</span></strong></p><p><code>oc create secret generic demo-secret --from-literal user=demo-use --from-literal root_password=zT1KTgk</code></p><p>&nbsp;</p><p><strong><span>Secret as Pod Env Variable</span></strong></p><p><span>Modify the env variables section of the deployment configuration</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">env:</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- name: MYSQL_ROOT_PASSWORD</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">valueFrom:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">secretKeyRef:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">name: demo-secret</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">key: root_password</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 138px;"></div><div class="CodeMirror-gutters" style="display: none; height: 138px;"></div></div></div></pre><p><u><span>Better</span></u><span>: CLI:</span></p><p><code>oc set env deployment/demo --from secret/demo-secret --prefix MYSQL_</code></p><p>&nbsp;</p><p><strong><span>Mount a file system inside a pod</span></strong></p><p><code>oc set volume deployment/demo --add --type secret --secret-name demo-secret --mount-path /app-secrets</code></p><p><span> </span></p><p><span>To update the secrets and config maps use the same extract and set data commands like in HTpasswd setup.</span></p><p>&nbsp;</p><h3 id='application-permissions-with-security-context-constraints'><span>Application Permissions with Security Context Constraints</span></h3><hr /><p><a href='do280.html'><span>Top</span></a></p><p><strong><span>Security Context Constraints (SCCs)</span></strong></p><p><span>a security mechanism that restricts access to resources, but not to operations in OpenShift</span></p><p><span>SCCs limit the access from a running pod in OpenShift to the host environment</span></p><ul><li><span>Running privileged containers.</span></li><li><span>Requesting extra capabilities for a container</span></li><li><span>Using host directories as volumes.</span></li><li><span>Changing the SELinux context of a container.</span></li><li><span>Changing the user ID.</span></li></ul><p><span>Show defined SCCs </span><code>oc get scc</code></p><p><span>To get more information about SCCs : </span><code>oc describe scc &lt;SCCs name&gt;</code></p><p><u><span>The 8 Default SCCs</span></u></p><ul><li><span>anyuid</span></li><li><span>hostaccess</span></li><li><span>hostmount-anyuid</span></li><li><span>hostnetwork</span></li><li><span>node-exporter</span></li><li><span>nonroot</span></li><li><span>privileged</span></li><li><span>restricted</span></li></ul><p>&nbsp;</p><p><span>View the SCCs on a pod : </span><code>oc describe pod &lt;pod name&gt; -n openshift-console | grep scc</code></p><p><span>Troubleshoot error: </span><code>oc logs pod/&lt;name&gt;</code></p><p><span>	</span><span>you can see insufficient permissions, etc.</span></p><p><strong><span>Fix SCCs issues</span></strong></p><p><a href='https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6/html/authentication_and_authorization/managing-pod-security-policies' target='_blank' class='url'>https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6/html/authentication_and_authorization/managing-pod-security-policies</a></p><p><code>oc get pod/&lt;podname&gt; -o yaml | oc adm policy scc-subject-review -f -</code></p><ol start='' ><li><p><code>oc create sa &lt;sa-name&gt;</code><span> </span></p></li><li><p><code>oc adm policy add-scc-to-user &lt;sa-type&gt; -z &lt;sa-name&gt;</code><span> </span></p></li><li><p><code>oc set serviceaccount deployment/&lt;deployment-name&gt; &lt;sa-name&gt;</code><span> </span></p><p><span>-OR-   </span><code>oc set serviceaccount dc/&lt;dc-name&gt; &lt;sa-name&gt;</code><span>   </span></p></li></ol><hr /><p>&nbsp;</p><h2 id='configuring-openshift-networking-for-applications'><span>Configuring OpenShift Networking for Applications</span></h2><p>〰️〰️〰️</p><p><a href='do280.html'><span>Top</span></a></p><h3 id='troubleshooting-software-defined-networking'><span>Troubleshooting Software-defined Networking</span></h3><p><span>Software-defined network (SDN) - manages the network infrastructure of the cluster and user applications. </span></p><p><u><span>SND satisfies the following five requirements:</span></u></p><ul><li><p><span>Managing the network traffic and network resources programmatically, so that the organization</span></p><p><span>teams can decide how to expose their applications.</span></p></li><li><p><span>Managing communication between containers that run in the same project.</span></p></li><li><p><span>Managing communication between pods, whether they belong to a same project or run in</span></p><p><span>separate projects.</span></p></li><li><p><span>Managing network communication from a pod to a service.</span></p></li><li><p><span>Managing network communication from an external network to a service, or from containers to</span></p><p><span>external networks.</span></p></li></ul><p>&nbsp;</p><p><span>Container Network Interface (CNI) - provides framework for vendors to have plug-ins that configure network interfaces inside container.</span></p><p><span>Common CNI plug-ins - OpenShift SND, Open Virtual Network (OVN)-Kubernetes, Kuryr (OVN to Openstack)</span></p><p>&nbsp;</p><p><strong><span>Using Services to Accessing Pods</span></strong></p><p><span>Services allow for the logical grouping of pods under a common access route. A service acts as a load balancer in front of one or more pods. Gives us a single IP and Port combination for all pods to use, independent of where the pods are running (in the same namespace).</span></p><p><u><span>YAML Service Example:</span></u></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">kind: Service</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">apiVersion: v1</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">metadata:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>name: application-frontend</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>labels:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>app: frontend-svc</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">spec:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>ports:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>- name: HTTP</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>  protocol: TCP</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>  port: 443</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>  targetPort: 8443</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  selector:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>  app: shopping-cart</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>  name: frontend</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  type: ClusterIP</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 368px;"></div><div class="CodeMirror-gutters" style="display: none; height: 368px;"></div></div></div></pre><p>&nbsp;</p><p>&nbsp;</p><p><strong><span>DNS Operator</span></strong></p><p><span>Internal DNS name resolution server</span></p><p><span>Every time you create an app, OpenShift configures the pod so that they contact the core DNS service ip for DNS resolution</span></p><ul><li><span>Responsible for creating a default cluster DNS name (cluster.local)</span></li><li><span>assigning DNS names to services that you define (for example db.backend.svc.cluster.local)</span></li></ul><p><span> Review the config of the DNS operator </span><code>oc describe dns.operator/default</code></p><p>&nbsp;</p><p><strong><span>Cluster Network Operator</span></strong></p><p><span>Managing the SDN. This includes the network CIDR to use, the network provider, and the IP address pools. This is done before installation.</span></p><p><span>consult the SDN config:  </span><code>oc get network/cluster -o yaml</code></p><hr /><p>&nbsp;</p><h3 id='exposing-applications-for-external-access'><span>Exposing Applications for External Access</span></h3><p><a href='do280.html'><span>Top</span></a></p><p><strong><span>Managing Ingress Traffic</span></strong></p><p><span>Route - routes alllow you to expose your apps to external networks. Routes rely on a router plug-in to redirect the traffic from the public IP to pods</span></p><p><span>Ingress - accpets external requests and proxy them based on the route</span></p><p><span>External Load balancer - instructs openshift to interact with the cloud provider in which the cluster is running</span></p><p><span>Service External IP - instructs openshift to set NAT rules to redirect traffice from one of the cluster Ips to the container</span></p><p><span>NodePort - exposes on a static port on the node IP.</span></p><p>&nbsp;</p><p><strong><span>Creating Routes</span></strong></p><p><code>oc expose service api-frontend --hostname api.apps.acme.com</code></p><p><u><span>Minimal definition for a route</span></u></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">kind: Route</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">apiVersion: route.openshift.io/v1</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">metadata:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>name: a-simple-route</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>labels:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>app: API</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>name: api-frontend</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>spec:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>host: api.apps.acme.com</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>to:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>kind: Service</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>name: api-frontend</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>port:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>targetPort: 8443</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 322px;"></div><div class="CodeMirror-gutters" style="display: none; height: 322px;"></div></div></div></pre><p>&nbsp;</p><p><strong><span>Securing Routes</span></strong></p><p><strong><span>Create a certificate edge route</span></strong></p><p><span>Edge certificates encrypt the traffic between the client and the router, but leave the traffic between the router and the service unencrypted. OpenShift generates its own certificate that it signs with its CA.</span></p><p><span>Generate a TLS certificate: </span><code>oc create route edge --service api-frontend --hostname api.apps.acme.com -key api.key --cert api.crt</code><span> </span></p><p><span>delete route </span><code>oc delete route todo-https</code></p><p>&nbsp;</p><p><strong><span>Passthrough</span></strong></p><p><span>Passthrough routes offer a secure alternative because the application exposes its TLS certificate. As such, the traffic is encrypted between the client and the application.</span></p><p><code>oc create route passthrough todo-https --service todo-https --port 8443 --hostname todo-https.apps.ocp4.example.com</code></p><p>&nbsp;</p><p><strong><span>Creating Certs</span></strong></p><ol start='' ><li><p><span>Create the private key</span></p><p><code>openssl genrsa -out training.key 2048</code></p></li><li><p><span>Generate a certificate signing request</span></p></li></ol><p><span>	</span><code>openssl req -new -subj &quot;/C=US/ST=North Carolina/L=Raleigh/O=Red Hat/CN=todo-https.apps.ocp4.example.com&quot; -key training.key -out training.csr</code></p><ol start='3' ><li><p><span>Generate a certificate</span></p><p><code>openssl x509 -req -in training.csr -passin file:passphrase.txt -CA training-CA.pem -CAkey training-CA.key -CAcreateserial -out training.crt -days 1825 -sha256 -extfile training.ext</code></p></li></ol><hr /><p>&nbsp;</p><h3 id='configuring-network-policies'><span>Configuring Network Policies</span></h3><p><a href='do280.html'><span>Top</span></a></p><p><span>Isolation policies for individual pods. used to create logical zones in the SDN that map to your organization newtork zones. </span></p><p><span>Manage newtork communication between two namespaces, assign a label to the namespace that needs access to another namespace</span></p><p><code>oc label namespace &lt;namespace name/network-1&gt; name=network-1</code></p><p><span>The network policy that allow communication between network-1 and network-2</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">kind: NetworkPolicy</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">apiVersion: networking.k8s.io/v1</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">metadata:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>name: network-1-policy</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">spec:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>podSelector:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>matchLabels:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>deployment: product-catalog</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>ingress:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>- from:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>- namespaceSelector:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>matchLabels:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>name: network-2</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>podSelector:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>matchLabels:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>role: qa</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>ports:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>- port: 8080</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>protocol: TCP</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 437px;"></div><div class="CodeMirror-gutters" style="display: none; height: 437px;"></div></div></div></pre><p><span>Get networkpolicy information: </span><code>oc get networkpolicies -n &lt;namespace name/network-policy&gt;</code></p><hr /><h3 id='exam-help-with-networking'><span>Exam help with networking </span></h3><p><span>  • Troubleshoot software defined networking </span></p><p><span>go over GE in book, p 125    </span></p><p><span> • Create and edit external routes</span></p><p><span> </span><a href='https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6/html/networking/configuring-routes' target='_blank' class='url'>https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6/html/networking/configuring-routes</a><span>    </span></p><p><span> • Control cluster network ingress </span><a href='https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6/html/networking/configuring-ingress' target='_blank' class='url'>https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6/html/networking/configuring-ingress</a><span>   </span></p><p><span>  • Create a self signed certificate   </span></p><p><span> • </span><a href='https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6/html/nodes/working-with-pods#nodes-pods-secrets' target='_blank' class='url'>https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6/html/nodes/working-with-pods#nodes-pods-secrets</a><span>   (look at 2.6.4???) </span></p><ol start='' ><li><p><code>openssl genrsa -out &lt;file.key&gt; 2048</code><span> </span></p></li><li><p><code>openssl req -new -x509 -key privkey.pem -out selfcert.pem</code><span>  </span></p></li><li><p><code>openssl x509 -n &lt;cert.pem&gt; -noout -text</code><span> </span></p><ol start='2' ><li><code>openssl req -new -subj “/C=US/ST=North Carolina/L=Raliegh/O=Red Hat/CN=[todo-https.apps.ocp4.example.com](http://todo-https.apps.ocp4.example.com/)” -key &lt;file.key&gt; -out &lt;file.csr&gt;</code><span> </span></li></ol></li></ol><p><span>openssl command – page 145q </span></p><p><span>man openssl-x509 &amp; man sscg    </span></p><p><span>	</span><span>• Secure routes using TLS certificates</span></p><p><span> </span><a href='https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6/html/networking/configuring-routes#configuring-default-certificate' target='_blank' class='url'>https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6/html/networking/configuring-routes#configuring-default-certificate</a><span> </span></p><p><code>oc create secret tls &lt;secret-name&gt; --cert &lt;cert.crt&gt; --key &lt;key.key&gt;</code><span> </span></p><p><code>oc create route passthrough &lt;route-name&gt; --service &lt;service-name&gt; --port &lt;port&gt; --hostname &lt;FQDN for route&gt;</code></p><hr /><p>&nbsp;</p><h2 id='controlling-pod-scheduling'><span>Controlling Pod Scheduling</span></h2><p>〰️〰️〰️</p><p><a href='do280.html'><span>Top</span></a></p><h3 id='pod-scheduling-behavior'><span>Pod Scheduling Behavior</span></h3><p><span>Scheduler Algorithm - determines placement of new pods onto nodes in the OpenShift cluster.</span></p><p><u><span>three steps</span></u></p><p><strong><span>Filtering Nodes</span></strong><span> - nodes that are going to be utalized get filtered through, wheter or not they get a particular work load. determine if node is struggling from pressure from resources (disk,cpu,memory), is it capable of running a workload. </span></p><p><span>Then it Checks for taints - requests from node. I want this with pod with these resources, acceptable tolerance (does it ask for certain resources).  A popular taint is NoSchedule- will not be scheudled to a control plane node.</span></p><p><strong><span>Prioritizing the filtered list of nodes</span></strong><span> - priority criteria that add up to a weighted score.</span></p><p><span>Affinity - scheudle things closer to one another. nodes are able to communicate more quickly. They could all break together.</span></p><p><span>anti-affinity - schedule things further apart. nodes get better resiliance against any faults.</span></p><p><strong><span>Selecting the best fit node</span></strong><span> - candidate list is sorted based on these scores, and the node with the highest scores is selected to host the pod.</span></p><p>&nbsp;</p><p><strong><span>Scheduling and Topology</span></strong></p><p><span>Regions - set of hosts in a close geographic area, high-speed connectivity</span></p><p><span>Zones (availability zone) - set of hosts that might fail togheter because they share common critical infrastructure components.</span></p><p>&nbsp;</p><p><strong><span>Labeling Nodes</span></strong></p><p><span>you can influence where those nodes will be set up by labeling them</span></p><p><span>Create label: </span><code>oc label node &lt;node name&gt; env=dev</code></p><p><span>Change existing label : </span><code>oc label node &lt;node name&gt; env=prod --overwrite</code></p><p><span>Remove label : </span><code>oc label node &lt;node name&gt; env-</code></p><p><span>Show Labels : </span><code>oc get node &lt;node name&gt; --show-labels</code></p><p><span>	</span><span>OR </span><code>oc get nodes -L env</code></p><p><span>Value of a single label: </span><code>oc get node -L &lt;node name&gt;</code></p><p>&nbsp;</p><p><strong><span>Labling Machine Sets</span></strong></p><p><span>using full-stack automation only in cloud environments. Figuring out where you want workloads spin up and label machine sets with workloads.</span></p><p><span>Identify relationship between machines and nodes</span></p><p><code>oc get machines -n &lt;name&gt; -o wide</code></p><p><span>List Machine Sets</span></p><p><code>oc get machineset -n openshift-machine-api</code></p><p>&nbsp;</p><p><strong><span>Manually scale replica pods</span></strong></p><p><code>oc scale --replicas 4 deployment/hello</code></p><p>&nbsp;</p><p><strong><span>OverView</span></strong></p><p><span>Scale replica pods </span><code>oc scale --replicas 4 deployment/hello</code></p><p><span>Check the pods are distributed : </span><code>oc get pods -o wide</code></p><p><span>Check Env labels: </span><code>oc get nodes -L env</code></p><p><span>Create label: </span><code>oc label node &lt;node name&gt; env=dev</code></p><p><span>Ensure deployment env is set </span><code>oc edit deployment/&lt;deploy name&gt;</code></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>nodeSelector:</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  env: dev</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="display: none; height: 69px;"></div></div></div></pre><p><span>Check pending pods, no logs</span></p><p><code>oc describe pod &lt;podname&gt;</code></p><p><span>make sure Client matches the deployment/</span><deploy name></p><hr /><p>&nbsp;</p><h3 id='limiting-resource-usage'><span>Limiting Resource Usage</span></h3><p><a href='do280.html'><span>Top</span></a></p><p><span>both resource requests and resource limits</span></p><p><strong><span>Resource Request</span></strong><span> - What resources does it want ? used for scheduling and to indicate a pod cannot run with less then the specified amount of resource. tries to find the node with sufficient resources to satisfy requests</span></p><p><strong><span>Resource Limits</span></strong><span> - upper threshold.  prevents a pod from using up all resources from a node. enforce resource limits</span></p><p><u><span>Deployment Config</span></u></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">spec:</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; containers:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; - image: quay.io/redhattraining/hello-world-nginx:v1.0</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; name: hello-world-nginx</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; resources:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  requests:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cpu: "10m" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; memory: 20Mi</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  limits: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (upper threshold)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cpu: "80m"</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; memory: 100Mi</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">status: {}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 276px;"></div><div class="CodeMirror-gutters" style="display: none; height: 276px;"></div></div></div></pre><p>&nbsp;</p><p><span>Set the same requests with CLI: </span><code>oc set resources deployment &lt;name/ hello-world-nginx&gt; --requests cpu=10m,memory=20Mi --limits cpu=80m,memory=100Mi</code></p><p>&nbsp;</p><p><strong><span>Viewing Requests, limits, and Actual usage</span></strong></p><p><span>Display requests/limits: </span><code>oc describe node &lt;node name&gt;</code></p><p><span>Show actual usage: </span><code>oc adm top nodes -l &lt;node name&gt;</code></p><p>&nbsp;</p><p><strong><span>Apply Quotas</span></strong></p><p><span>Object counts - number of objects/nodes/secrets</span></p><p><span>Compute Resources -  number of pyshical or virtual resources</span></p><p><span>CLI: </span><code>oc create quota dev-quota --hard services=10,cpu=1300,memory=1.5Gi</code></p><p><span>Get quotas : </span><code>oc get resourcequota</code></p><p><span>Detailed info : </span><code>oc describe quota</code></p><p><span>delete: </span><code>oc delete resourcequota &lt;QUOTA&gt;</code></p><p>&nbsp;</p><p><strong><span>Apply Quotas to Multiple Projects</span></strong></p><p><span>Creating a cluster resource quota for all projects owned by the qa user</span></p><p><code>oc create clusterquota user-qa --project-annotation-selector openshift.io/requester=qa --hard pods=12,secrets=20</code></p><p><span>creating a cluster resource quota for all projects that have been assigned the env variable qa  label</span></p><p><code>oc create clusterquota env-qa --project-label-selector environment=qa --hard pods=10,services=5</code></p><hr /><p>&nbsp;</p><h3 id='scaling-an-application'><span>Scaling an Application</span></h3><p><a href='do280.html'><span>Top</span></a></p><p><span>grow or reduce the amount of pods servicing our workload</span></p><p><span>	</span><span>desired number of replicas</span></p><p><span>	</span><span>selector for identifing managed pods</span></p><p><span>	</span><span>a pod definition, or template, for creating a replicated pod</span></p><p>&nbsp;</p><p><strong><span>Manually Scaling</span></strong></p><p><span>oc get deployment</span></p><p><span>oc scale --replicas 5 deployment/scale</span></p><p>&nbsp;</p><p><strong><span>Autoscaling Pods</span></strong></p><p><span>min/max cpu of pods</span></p><p><code>oc autoscale deployment/&lt;name&gt; --min 1 --max 10 --cpu-percent 80</code></p><p><span>To get information about horizonal pod autoscaler resources: </span><code>oc get hpa</code></p><hr /><p>&nbsp;</p><h3 id='exam-help-with-pod-scheduling'><span>Exam Help With Pod Scheduling</span></h3><p><a href='do280.html'><span>Top</span></a></p><p><span>Configure pod scheduling</span>
<span>    • Limit resource usage</span>
<a href='https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6/html/applications/quotas' target='_blank' class='url'>https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6/html/applications/quotas</a>
<a href='https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6/html/nodes/working-with-clusters#nodes-cluster-limit-ranges' target='_blank' class='url'>https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6/html/nodes/working-with-clusters#nodes-cluster-limit-ranges</a>
<span>p191 –</span></p><p><span> </span><code>oc set resources deployment &lt;deployment-name&gt; --requests cpu=10m,memory=20Mi --limits cpu=80m,memory=100Mi</code></p><p><span>or you can use oc edit and modify the resources section</span></p><p>&nbsp;</p><p><span>• Scale applications to meet increased demand</span></p><p><a href='https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6/html/nodes/working-with-pods#nodes-pods-autoscaling' target='_blank' class='url'>https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6/html/nodes/working-with-pods#nodes-pods-autoscaling</a></p><p><code>oc scale --replicas &lt;#&gt; deployment/&lt;deployment-name&gt;</code>
<code>oc autoscale deployment/&lt;deployment-name&gt; --min # --max # --cpu-percent #</code>
<code>oc get hpa/&lt;deployment-name&gt;</code></p><p><span>• Control pod placement across cluster nodes</span></p><p><a href='https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6/html/nodes/working-with-pods#nodes-pods-node-selectors' target='_blank' class='url'>https://access.redhat.com/documentation/en-us/openshift_container_platform/4.6/html/nodes/working-with-pods#nodes-pods-node-selectors</a></p><p><span>Labels:</span>
<code>oc get nodes --show-labels</code>
<code>oc get nodes -L &lt;label&gt;</code>
<code>oc label node &lt;node-name&gt; &lt;key=value&gt;</code></p><p><span>Affinity: </span><a href='https://access.redhat.com/documentation/en-us/openshift_container_platform/4.1/html/nodes/controlling-pod-placement-onto-nodes-scheduling' target='_blank' class='url'>https://access.redhat.com/documentation/en-us/openshift_container_platform/4.1/html/nodes/controlling-pod-placement-onto-nodes-scheduling</a></p><p>&nbsp;</p><p><span>Taints:  </span></p><p><a href='https://docs.openshift.com/container-platform/4.5/nodes/scheduling/nodes-scheduler-taints-tolerations.html' target='_blank' class='url'>https://docs.openshift.com/container-platform/4.5/nodes/scheduling/nodes-scheduler-taints-tolerations.html</a>
<code>oc describe nodes &lt;node-name&gt; | grep Taints</code>
<span>add Taint:  </span><code>oc adm taint nodes &lt;node&gt; noderole.kubernetes.io/master:NoSchedule</code>
<code>oc adm taint nodes ip-10-0-132-248.ec2.internal key1-</code>
<span>remove Taint: </span><code>oc adm taint nodes &lt;node&gt; noderole.kubernetes.io/master:NoSchedule-</code>
<code>oc describe nodes &lt;node-name&gt; | grep -i taints   (to verify taint removed)</code></p><p><span>Configure cluster scaling</span>
<span>Appendix in book</span>
<span>    • Manually control the number of cluster workers</span>
<span>    • Automatically scale the number of cluster workers</span></p><hr /><p>&nbsp;</p><p>&nbsp;</p><h2 id='describing-cluster-updates'><span>Describing Cluster Updates</span></h2><p>〰️〰️〰️</p><p><a href='do280.html'><span>Top</span></a></p><h3 id='cluster-update-process'><span>Cluster Update Process</span></h3><p><span>Over the air (ota), continuous connection to the internet</span></p><p><span>ensures a cluster runs the latest avaialbe version seamlessly.</span></p><p><span>Red Hat Hosts and manages services at :</span></p><p><a href='https://cloud.redhat.com/openshift' target='_blank' class='url'>https://cloud.redhat.com/openshift</a><span> and </span><a href='https://quay.io' target='_blank' class='url'>https://quay.io</a></p><p><span>You can check the status to verify update/version. defined in </span><u><span>upgrade paths</span></u></p><p>&nbsp;</p><p><strong><span>Channels</span></strong></p><p><span>Candidate channel -delivers updates for testing feature acceptance in the next version of the container platform</span></p><p><span>Fast Channel - delvier updates as soon as they are available</span></p><p><span>Stable Channel - contains delayed updates, delivers only minor updates for a given cluster version</span></p><p><span>Extended updates Support Channel - offered in certain minor versions to customers with Premium subs.</span></p><p>&nbsp;</p><p><strong><span>Changing Update Channel</span></strong></p><p><span>You can update channel to stable-4.6,fast, or candidate by using the web console</span></p><p><span>Administration-&gt;Cluster Settings, then click the pencil icon</span></p><p><span>Using the CLI : </span><code>oc patch clusterverions version --type=&quot;merge&quot; --patch &#39;{&quot;spec&quot;:{&quot;channel&quot;:&quot;fast-4.6&quot;}}&#39;</code></p><p>&nbsp;</p><p><strong><span>Updating the Cluster</span></strong></p><p><u><span>Web</span></u><span> - Admin -&gt; cluster settings, </span><u><span>update status of update available</span></u><span> -&gt; click update now</span></p><p><u><span>CLI</span></u>
<span>Get Cluster version: </span><code>oc get clusterversion</code></p><p><span>View available updates: </span><code>oc adm upgrade</code></p><p><span>Apply the lastest update or specifiy version: </span><code>oc adm upgrade --to-latest=true</code></p><p><span>	</span><span>or </span><code>oc adm upgrade --to=&lt;Version&gt;</code></p><p><span>Review Status: </span></p><p><span>	</span><code>oc get clusteroperators</code></p><p><span>	</span><code>oc get clusterversion</code></p><p><span>Confirm: </span><code>oc describe clusterversion</code></p><hr /><p>&nbsp;</p><p>&nbsp;</p><h2 id='managing-a-cluster-with-the-web-console'><span>Managing a Cluster with the Web Console</span></h2><p>〰️〰️〰️</p><p><a href='do280.html'><span>Top</span></a></p><h3 id='cluster-administration'><span>Cluster Administration</span></h3><p><span>Accessing the OpenShift Web Console</span></p><p><code>oc get routes -n openshift-console</code></p><p><code>oc whoami --show-console</code></p><p><span>Two Perspectives - Administrator and Developer</span></p><p><span>	</span><span>You may need to switch between views to access certain features</span></p><p><span>	</span><span>And filter through projects</span></p><p><span>Locate resources by using the search page </span><strong><span>Home -&gt; Search</span></strong></p><p><span>you can filter pods by state to identify potential issues or problematic deployments</span></p><p>&nbsp;</p><p><strong><span>Create Users and Groups</span></strong></p><p><span>User Management -&gt; Users - displays users who have previously logged into Openshift.</span></p><p><span>You can use the Web to edit the HTPasswd secret created with the CLI.</span></p><p><span>	</span><span>Inside the openshift-config project  Actions-&gt; Edit Secret. </span></p><p><span>	</span><span>Add a line to allow a new user, change password, and delete users</span></p><p><span>Group managment - User Management -&gt; Groups</span></p><p>&nbsp;</p><p><strong><span>Creating a Project</span></strong></p><p><span>Home -&gt; Projects , new project</span></p><p><span>Navigate to Role Bindings</span></p><p><span>Configure Resource Quotas and Limit ranges in Administration -&gt; Resource Quota / Administration -&gt; limit Range</span></p><hr /><p>&nbsp;</p><h3 id='managing-workloads-and-operators'><span>Managing Workloads and Operators</span></h3><p><a href='do280.html'><span>Top</span></a></p><p><strong><span>Workload Resources</span></strong></p><p><span>Workloads menu - Workloads-&gt;Pods , choose project </span></p><p>&nbsp;</p><p><strong><span>Manage Workloads</span></strong></p><p><span>Actions on the resources details page to navigate to the special editor pages</span></p><p><span>All resources feature Edit Labels and Edit Annotations editors.</span>
<span>• Click Actions → Add Storage to add a Persistent Volume Claim (PVC) to a deployment.</span>
<span>• To edit the replica count, navigate to the Deployment Details page and click Actions → Edit</span>
<span>Pod Count.</span>
<span>• To modify the update strategy for a deployment, such as changing rolling update parameters,</span>
<span>navigate to the Deployment Details page and click Actions → Edit Update Strategy. To modify</span>
<span>the update strategy for a deployment configuration, navigate to the Deployment Config Details</span>
<span>page and click Actions → Edit Deployment Config.</span>
<span>• Navigate to the Secret Details page and click Actions → Edit Secret to display the Edit Key/</span>
<span>Value Secret tool, which automatically uses Base64 to encode and decode values</span></p><p>&nbsp;</p><p><strong><span>Deploy Applications</span></strong></p><p><span>you can create deployment resources from Workloads-&gt; Deployments. Provides a YAML editor.</span></p><p><span>Install using Operators - Operators-&gt;OperatorsHub, several operators are avaialble for installation.</span></p><p><span> When you find the operator you want, click install and complete the Operator Installation form.</span></p><p><span>After you have installed an operator it appers in Operators-&gt;Installed Operators</span></p><p>&nbsp;</p><h3 id='examining-cluster-metrics'><span>Examining Cluster Metrics</span></h3><p><strong><span>Viewing Cluster Metrics</span></strong></p><p><span>Home -&gt; Overview / Project Details -&gt; Utilization/ Pod Details</span></p><p><span>Monitoring -&gt; Metrics , enter prometheus Query language, Run Queries (you need an understanding of Prometheus)</span></p><hr /><p>&nbsp;</p></div></div>
</body>
</html>